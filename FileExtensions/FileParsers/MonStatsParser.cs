using D2RReimaginedTools.Extensions;
using D2RReimaginedTools.Models;

namespace D2RReimaginedTools.FileParsers;

public class MonStatsParser
{
    public static async Task<IList<MonStat>> GetEntries(string path)
    {
        var lines = (await File.ReadAllLinesAsync(path)).Skip(1); // Skip header line

        return lines.Select(line => line.Split('\t'))
            .Select(columns => new MonStat
            {
                Id = columns[0],
                HcIdx = columns[1].ToInt(),
                BaseId = columns[2],
                NextInClass = columns[3],
                TransLvl = columns[4].ToInt(),
                NameStr = columns[5],
                MonStatsEx = columns[6],
                MonProp = columns[7],
                MonType = columns[8],
                AI = columns[9],
                DescStr = columns[10],
                Code = columns[11],
                Enabled = columns[12].ToInt(),
                RangedType = columns[13],
                PlaceSpawn = columns[14],
                Spawn = columns[15],
                SpawnX = columns[16],
                SpawnY = columns[17],
                SpawnMode = columns[18],
                Minion1 = columns[19],
                Minion2 = columns[20],
                SetBoss = columns[21],
                BossXfer = columns[22],
                PartyMin = columns[23],
                PartyMax = columns[24],
                MinGrp = columns[25],
                MaxGrp = columns[26],
                SparsePopulate = columns[27],
                Velocity = columns[28].ToInt(),
                Run = columns[29].ToInt(),
                Rarity = columns[30],
                Level = columns[31].ToInt(),
                LevelN = columns[32].ToInt(),
                LevelH = columns[33].ToInt(),
                MonSound = columns[34],
                UMonSound = columns[35],
                Threat = columns[36],
                AIDel = columns[37],
                AIDelN = columns[38],
                AIDelH = columns[39],
                AIDist = columns[40],
                AIDistN = columns[41],
                AIDistH = columns[42],
                AIP1 = columns[43],
                AIP1N = columns[44],
                AIP1H = columns[45],
                AIP2 = columns[46],
                AIP2N = columns[47],
                AIP2H = columns[48],
                AIP3 = columns[49],
                AIP3N = columns[50],
                AIP3H = columns[51],
                AIP4 = columns[52],
                AIP4N = columns[53],
                AIP4H = columns[54],
                AIP5 = columns[55],
                AIP5N = columns[56],
                AIP5H = columns[57],
                AIP6 = columns[58],
                AIP6N = columns[59],
                AIP6H = columns[60],
                AIP7 = columns[61],
                AIP7N = columns[62],
                AIP7H = columns[63],
                AIP8 = columns[64],
                AIP8N = columns[65],
                AIP8H = columns[66],
                MissA1 = columns[67],
                MissA2 = columns[68],
                MissS1 = columns[69],
                MissS2 = columns[70],
                MissS3 = columns[71],
                MissS4 = columns[72],
                MissC = columns[73],
                MissSQ = columns[74],
                Align = columns[75],
                IsSpawn = columns[76],
                IsMelee = columns[77],
                Npc = columns[78],
                Interact = columns[79],
                Inventory = columns[80],
                InTown = columns[81],
                LUndead = columns[82],
                HUndead = columns[83],
                Demon = columns[84],
                Flying = columns[85],
                OpenDoors = columns[86],
                Boss = columns[87],
                PrimeEvil = columns[88],
                Killable = columns[89],
                SwitchAI = columns[90],
                NoAura = columns[91],
                NoMultiShot = columns[92],
                NeverCount = columns[93],
                PetIgnore = columns[94],
                DeathDmg = columns[95],
                GenericSpawn = columns[96],
                Zoo = columns[97],
                CannotDesecrate = columns[98],
                RightArmItemType = columns[99],
                LeftArmItemType = columns[100],
                CanNotUseTwoHandedItems = columns[101],
                SendSkills = columns[102],
                Skill1 = columns[103],
                Sk1Mode = columns[104],
                Sk1Lvl = columns[105].ToNullableInt(),
                Skill2 = columns[106],
                Sk2Mode = columns[107],
                Sk2Lvl = columns[108].ToNullableInt(),
                Skill3 = columns[109],
                Sk3Mode = columns[110],
                Sk3Lvl = columns[111].ToNullableInt(),
                Skill4 = columns[112],
                Sk4Mode = columns[113],
                Sk4Lvl = columns[114].ToNullableInt(),
                Skill5 = columns[115],
                Sk5Mode = columns[116],
                Sk5Lvl = columns[117].ToNullableInt(),
                Skill6 = columns[118],
                Sk6Mode = columns[119],
                Sk6Lvl = columns[120].ToNullableInt(),
                Skill7 = columns[121],
                Sk7Mode = columns[122],
                Sk7Lvl = columns[123].ToNullableInt(),
                Skill8 = columns[124],
                Sk8Mode = columns[125],
                Sk8Lvl = columns[126].ToNullableInt(),
                Drain = columns[127].ToNullableInt(),
                DrainN = columns[128].ToNullableInt(),
                DrainH = columns[129].ToNullableInt(),
                ColdEffect = columns[130].ToNullableInt(),
                ColdEffectN = columns[131].ToNullableInt(),
                ColdEffectH = columns[132].ToNullableInt(),
                ResDm = columns[133].ToNullableInt(),
                ResMa = columns[134].ToNullableInt(),
                ResFi = columns[135].ToNullableInt(),
                ResLi = columns[136].ToNullableInt(),
                ResCo = columns[137].ToNullableInt(),
                ResPo = columns[138].ToNullableInt(),
                ResDmN = columns[139].ToNullableInt(),
                ResMaN = columns[140].ToNullableInt(),
                ResFiN = columns[141].ToNullableInt(),
                ResLiN = columns[142].ToNullableInt(),
                ResCoN = columns[143].ToNullableInt(),
                ResPoN = columns[144].ToNullableInt(),
                ResDmH = columns[145].ToNullableInt(),
                ResMaH = columns[146].ToNullableInt(),
                ResFiH = columns[147].ToNullableInt(),
                ResLiH = columns[148].ToNullableInt(),
                ResCoH = columns[149].ToNullableInt(),
                ResPoH = columns[150].ToNullableInt(),
                DamageRegen = columns[151].ToNullableInt(),
                SkillDamage = columns[152].ToNullableInt(),
                NoRatio = columns[153].ToNullableInt(),
                ShieldBlockOverride = columns[154].ToNullableInt(),
                ToBlock = columns[155].ToNullableInt(),
                ToBlockN = columns[156].ToNullableInt(),
                ToBlockH = columns[157].ToNullableInt(),
                Crit = columns[158].ToNullableInt(),
                MinHP = columns[159].ToNullableInt(),
                MaxHP = columns[160].ToNullableInt(),
                AC = columns[161].ToNullableInt(),
                Exp = columns[162].ToNullableInt(),
                A1MinD = columns[163].ToNullableInt(),
                A1MaxD = columns[164].ToNullableInt(),
                A1TH = columns[165].ToNullableInt(),
                A2MinD = columns[166].ToNullableInt(),
                A2MaxD = columns[167].ToNullableInt(),
                A2TH = columns[168].ToNullableInt(),
                S1MinD = columns[169].ToNullableInt(),
                S1MaxD = columns[170].ToNullableInt(),
                S1TH = columns[171].ToNullableInt(),
                MinHPN = columns[172].ToNullableInt(),
                MaxHPN = columns[173].ToNullableInt(),
                ACN = columns[174].ToNullableInt(),
                ExpN = columns[175].ToNullableInt(),
                A1MinDN = columns[176].ToNullableInt(),
                A1MaxDN = columns[177].ToNullableInt(),
                A1THN = columns[178].ToNullableInt(),
                A2MinDN = columns[179].ToNullableInt(),
                A2MaxDN = columns[180].ToNullableInt(),
                A2THN = columns[181].ToNullableInt(),
                S1MinDN = columns[182].ToNullableInt(),
                S1MaxDN = columns[183].ToNullableInt(),
                S1THN = columns[184].ToNullableInt(),
                MinHPH = columns[185].ToNullableInt(),
                MaxHPH = columns[186].ToNullableInt(),
                ACH = columns[187].ToNullableInt(),
                ExpH = columns[188].ToNullableInt(),
                A1MinDH = columns[189].ToNullableInt(),
                A1MaxDH = columns[190].ToNullableInt(),
                A1THH = columns[191].ToNullableInt(),
                A2MinDH = columns[192].ToNullableInt(),
                A2MaxDH = columns[193].ToNullableInt(),
                A2THH = columns[194].ToNullableInt(),
                S1MinDH = columns[195].ToNullableInt(),
                S1MaxDH = columns[196].ToNullableInt(),
                S1THH = columns[197].ToNullableInt(),
                El1Mode = columns[198],
                El1Type = columns[199],
                El1Pct = columns[200].ToNullableInt(),
                El1MinD = columns[201].ToNullableInt(),
                El1MaxD = columns[202].ToNullableInt(),
                El1Dur = columns[203].ToNullableInt(),
                El1PctN = columns[204].ToNullableInt(),
                El1MinDN = columns[205].ToNullableInt(),
                El1MaxDN = columns[206].ToNullableInt(),
                El1DurN = columns[207].ToNullableInt(),
                El1PctH = columns[208].ToNullableInt(),
                El1MinDH = columns[209].ToNullableInt(),
                El1MaxDH = columns[210].ToNullableInt(),
                El1DurH = columns[211].ToNullableInt(),
                El2Mode = columns[212],
                El2Type = columns[213],
                El2Pct = columns[214].ToNullableInt(),
                El2MinD = columns[215].ToNullableInt(),
                El2MaxD = columns[216].ToNullableInt(),
                El2Dur = columns[217].ToNullableInt(),
                El2PctN = columns[218].ToNullableInt(),
                El2MinDN = columns[219].ToNullableInt(),
                El2MaxDN = columns[220].ToNullableInt(),
                El2DurN = columns[221].ToNullableInt(),
                El2PctH = columns[222].ToNullableInt(),
                El2MinDH = columns[223].ToNullableInt(),
                El2MaxDH = columns[224].ToNullableInt(),
                El2DurH = columns[225].ToNullableInt(),
                El3Mode = columns[226],
                El3Type = columns[227],
                El3Pct = columns[228].ToNullableInt(),
                El3MinD = columns[229].ToNullableInt(),
                El3MaxD = columns[230].ToNullableInt(),
                El3Dur = columns[231].ToNullableInt(),
                El3PctN = columns[232].ToNullableInt(),
                El3MinDN = columns[233].ToNullableInt(),
                El3MaxDN = columns[234].ToNullableInt(),
                El3DurN = columns[235].ToNullableInt(),
                El3PctH = columns[236].ToNullableInt(),
                El3MinDH = columns[237].ToNullableInt(),
                El3MaxDH = columns[238].ToNullableInt(),
                El3DurH = columns[239].ToNullableInt(),
                TreasureClass = columns[240],
                TreasureClassChamp = columns[241],
                TreasureClassUnique = columns[242],
                TreasureClassQuest = columns[243],
                TreasureClassDesecrated = columns[244],
                TreasureClassDesecratedChamp = columns[245],
                TreasureClassDesecratedUnique = columns[246],
                TreasureClassN = columns[247],
                TreasureClassChampN = columns[248],
                TreasureClassUniqueN = columns[249],
                TreasureClassQuestN = columns[250],
                TreasureClassDesecratedN = columns[251],
                TreasureClassDesecratedChampN = columns[252],
                TreasureClassDesecratedUniqueN = columns[253],
                TreasureClassH = columns[254],
                TreasureClassChampH = columns[255],
                TreasureClassUniqueH = columns[256],
                TreasureClassQuestH = columns[257],
                TreasureClassDesecratedH = columns[258],
                TreasureClassDesecratedChampH = columns[259],
                TreasureClassDesecratedUniqueH = columns[260],
                TCQuestId = columns[261].ToNullableInt(),
                TCQuestCP = columns[262].ToNullableInt(),
                SplEndDeath = columns[263].ToNullableInt(),
                SplGetModeChart = columns[264].ToNullableInt(),
                SplEndGeneric = columns[265].ToNullableInt(),
                SplClientEnd = columns[266].ToNullableInt(),
                Eol = columns[^1].ToInt()
            }).ToList();
    }
}