using D2RReimaginedTools.Extensions;
using D2RReimaginedTools.Models;

namespace D2RReimaginedTools.FileParsers;
public static class MissilesParser
{
    public static async Task<IList<Missiles>> GetEntries(string path)
    {
        var lines = (await File.ReadAllLinesAsync(path)).Skip(1);
        return lines.Select(columns => columns.Split('\t'))
                    .Select(columns => new Missiles
                    {
                        MissileName = columns[0],
                        MissileId = columns[1].ToInt(),
                        ClientDoFunction = columns[2].ToNullableInt(),
                        ClientHitFunction = columns[3].ToNullableInt(),
                        ServerDoFunction = columns[4].ToNullableInt(),
                        ServerHitFunction = columns[5].ToNullableInt(),
                        ServerDamageFunction = columns[6].ToNullableInt(),
                        ServerCalculation1 = columns[7],
                        ServerCalculation1Description = columns[8],
                        Param1 = columns[9].ToNullableInt(),
                        Param1Description = columns[10],
                        Param2 = columns[11].ToNullableInt(),
                        Param2Description = columns[12],
                        Param3 = columns[13].ToNullableInt(),
                        Param3Description = columns[14],
                        Param4 = columns[15].ToNullableInt(),
                        Param4Description = columns[16],
                        Param5 = columns[17].ToNullableInt(),
                        Param5Description = columns[18],
                        ClientCalculation1 = columns[19],
                        ClientCalculation1Description = columns[20],
                        ClientParam1 = columns[21].ToNullableInt(),
                        ClientParam1Description = columns[22],
                        ClientParam2 = columns[23].ToNullableInt(),
                        ClientParam2Description = columns[24],
                        ClientParam3 = columns[25].ToNullableInt(),
                        ClientParam3Description = columns[26],
                        ClientParam4 = columns[27].ToNullableInt(),
                        ClientParam4Description = columns[28],
                        ClientParam5 = columns[29].ToNullableInt(),
                        ClientParam5Description = columns[30],
                        ServerHitCalculation1 = columns[31],
                        ServerHitCalculation1Description = columns[32],
                        ServerHitParam1 = columns[33].ToNullableInt(),
                        ServerHitParam1Description = columns[34],
                        ServerHitParam2 = columns[35].ToNullableInt(),
                        ServerHitParam2Description = columns[36],
                        ServerHitParam3 = columns[37].ToNullableInt(),
                        ServerHitParam3Description = columns[38],
                        ClientHitCalculation1 = columns[39],
                        ClientHitCalculation1Description = columns[40],
                        ClientHitParam1 = columns[41].ToNullableInt(),
                        ClientHitParam1Description = columns[42],
                        ClientHitParam2 = columns[43].ToNullableInt(),
                        ClientHitParam2Description = columns[44],
                        ClientHitParam3 = columns[45].ToNullableInt(),
                        ClientHitParam3Description = columns[46],
                        DamageCalculation1 = columns[47],
                        DamageParam1 = columns[48],
                        DamageParam2 = columns[49],
                        Velocity = columns[50].ToNullableInt(),
                        MaxVelocity = columns[51].ToNullableInt(),
                        VelocityLevel = columns[52].ToNullableInt(),
                        Acceleration = columns[53].ToNullableInt(),
                        Range = columns[54].ToNullableInt(),
                        LevelRange = columns[55].ToNullableInt(),
                        Light = columns[56].ToNullableInt(),
                        Flicker = columns[57].ToNullableInt(),
                        Red = columns[58].ToNullableInt(),
                        Green = columns[59].ToNullableInt(),
                        Blue = columns[60].ToNullableInt(),
                        InitSteps = columns[61].ToNullableInt(),
                        Activate = columns[62].ToNullableInt(),
                        LoopAnimation = columns[63].ToNullableInt(),
                        CelFile = columns[64],
                        AnimationRate = columns[65].ToNullableInt(),
                        AnimationLength = columns[66].ToNullableInt(),
                        AnimationSpeed = columns[67].ToNullableInt(),
                        RandomStart = columns[68].ToNullableInt(),
                        SubLoop = columns[69].ToNullableInt(),
                        SubStart = columns[70].ToNullableInt(),
                        SubStop = columns[71].ToNullableInt(),
                        CollideType = columns[72].ToNullableInt(),
                        CollideKill = columns[73].ToNullableInt(),
                        CollideFriend = columns[74].ToNullableInt(),
                        LastCollide = columns[75].ToNullableInt(),
                        Collision = columns[76].ToNullableInt(),
                        ClientCollision = columns[77].ToNullableInt(),
                        ClientSend = columns[78].ToNullableInt(),
                        NextHit = columns[79].ToNullableInt(),
                        NextDelay = columns[80].ToNullableInt(),
                        XOffset = columns[81].ToNullableInt(),
                        YOffset = columns[82].ToNullableInt(),
                        ZOffset = columns[83].ToNullableInt(),
                        Size = columns[84].ToNullableInt(),
                        SourceTown = columns[85].ToNullableInt(),
                        ClientSourceTown = columns[86].ToNullableInt(),
                        CanDestroy = columns[87].ToNullableInt(),
                        ToHit = columns[88].ToNullableInt(),
                        AlwaysExplode = columns[89].ToNullableInt(),
                        Explosion = columns[90],
                        Town = columns[91].ToNullableInt(),
                        NoUniqueMod = columns[92].ToNullableInt(),
                        NoMultiShot = columns[93].ToNullableInt(),
                        Holy = columns[94].ToNullableInt(),
                        CanSlow = columns[95].ToNullableInt(),
                        ReturnFire = columns[96].ToNullableInt(),
                        GetHit = columns[97].ToNullableInt(),
                        SoftHit = columns[98].ToNullableInt(),
                        KnockBack = columns[99].ToNullableInt(),
                        Trans = columns[100],
                        Pierce = columns[101].ToNullableInt(),
                        MissileSkill = columns[102].ToNullableInt(),
                        Skill = columns[103],
                        ResultFlags = columns[104].ToNullableInt(),
                        HitFlags = columns[105].ToNullableInt(),
                        HitShift = columns[106].ToNullableInt(),
                        ApplyMastery = columns[107].ToNullableInt(),
                        SourceDamage = columns[108].ToNullableInt(),
                        Half2HSource = columns[109].ToNullableInt(),
                        SourceMissileDamage = columns[110].ToNullableInt(),
                        MinDamage = columns[111].ToNullableInt(),
                        MinLevelDamage1 = columns[112].ToNullableInt(),
                        MinLevelDamage2 = columns[113].ToNullableInt(),
                        MinLevelDamage3 = columns[114].ToNullableInt(),
                        MinLevelDamage4 = columns[115].ToNullableInt(),
                        MinLevelDamage5 = columns[116].ToNullableInt(),
                        MaxDamage = columns[117].ToNullableInt(),
                        MaxLevelDamage1 = columns[118].ToNullableInt(),
                        MaxLevelDamage2 = columns[119].ToNullableInt(),
                        MaxLevelDamage3 = columns[120].ToNullableInt(),
                        MaxLevelDamage4 = columns[121].ToNullableInt(),
                        MaxLevelDamage5 = columns[122].ToNullableInt(),
                        DamageSymPerCalculation = columns[123],
                        ElementalType = columns[124],
                        ElementalMin = columns[125].ToNullableInt(),
                        MinElementalLevel1 = columns[126].ToNullableInt(),
                        MinElementalLevel2 = columns[127].ToNullableInt(),
                        MinElementalLevel3 = columns[128].ToNullableInt(),
                        MinElementalLevel4 = columns[129].ToNullableInt(),
                        MinElementalLevel5 = columns[130].ToNullableInt(),
                        ElementalMax = columns[131].ToNullableInt(),
                        MaxElementalLevel1 = columns[132].ToNullableInt(),
                        MaxElementalLevel2 = columns[133].ToNullableInt(),
                        MaxElementalLevel3 = columns[134].ToNullableInt(),
                        MaxElementalLevel4 = columns[135].ToNullableInt(),
                        MaxElementalLevel5 = columns[136].ToNullableInt(),
                        ElementalDamageSymPerCalculation = columns[137],
                        ElementalLength = columns[138],
                        ElementalLevelLength1 = columns[139].ToNullableInt(),
                        ElementalLevelLength2 = columns[140].ToNullableInt(),
                        ElementalLevelLength3 = columns[141].ToNullableInt(),
                        HitClass = columns[142],
                        NumberOfDirections = columns[143].ToNullableInt(),
                        LocalBlood = columns[144].ToNullableInt(),
                        DamageRate = columns[145].ToNullableInt(),
                        TravelSound = columns[146],
                        HitSound = columns[147],
                        ProgressSound = columns[148],
                        ProgressOverlay = columns[149],
                        ExplosionMissile = columns[150],
                        SubMissile1 = columns[151],
                        SubMissile2 = columns[152],
                        SubMissile3 = columns[153],
                        HitSubMissile1 = columns[154],
                        HitSubMissile2 = columns[155],
                        HitSubMissile3 = columns[156],
                        HitSubMissile4 = columns[157],
                        ClientSubMissile1 = columns[158],
                        ClientSubMissile2 = columns[159],
                        ClientSubMissile3 = columns[160],
                        ClientHitSubMissile1 = columns[161],
                        ClientHitSubMissile2 = columns[162],
                        ClientHitSubMissile3 = columns[163],
                        ClientHitSubMissile4 = columns[164],
                    }).ToList();
    }
}
